class LiveChatSystem{constructor(){this.isOpen=!1,this.unreadMessages=0,this.chatHistory=[],this.init()}init(){this.createChatWidget(),this.loadChatHistory(),this.setupEventListeners()}createChatWidget(){document.body.insertAdjacentHTML('beforeend',`<div id="live-chat-widget" class="live-chat-widget"><div class="chat-toggle-btn" id="chatToggleBtn"><span class="chat-icon">ðŸ’¬</span><span class="notification-badge" id="chatBadge">0</span></div><div class="chat-window" id="chatWindow"><div class="chat-header"><h4>Arabfield Academy Support</h4><span class="status-dot online"></span><span class="status-text">Online</span><button class="close-chat" id="closeChat">Ã—</button></div><div class="chat-messages" id="chatMessages"><div class="system-message"><p>ðŸ‘‹ Welcome! Our team is here to help with any questions about Arabic learning.</p></div></div><div class="quick-questions"><button class="quick-btn" data-question="What's the best program for beginners?">Beginner Programs</button><button class="quick-btn" data-question="How much does it cost?">Pricing</button><button class="quick-btn" data-question="Can I try a free lesson?">Free Trial</button></div><div class="chat-input-area"><textarea id="chatInput" placeholder="Type your message..." rows="2"></textarea><button id="sendMessage" class="send-btn">Send</button></div></div></div>`)}setupEventListeners(){document.getElementById('chatToggleBtn').addEventListener('click',(()=>this.toggleChat())),document.getElementById('closeChat').addEventListener('click',(()=>this.closeChat())),document.getElementById('sendMessage').addEventListener('click',(()=>this.sendMessage())),document.getElementById('chatInput').addEventListener('keypress',(t=>{'Enter'===t.key&&!t.shiftKey&&(t.preventDefault(),this.sendMessage())})),document.querySelectorAll('.quick-btn').forEach((t=>{t.addEventListener('click',(()=>{const e=t.getAttribute('data-question');this.addMessage(e,'user'),this.sendToSupport(e)}))})),document.addEventListener('click',(t=>{const e=document.getElementById('live-chat-widget');e.contains(t.target)||this.isOpen||this.closeChat()}))}toggleChat(){this.isOpen=!this.isOpen;const t=document.getElementById('chatWindow');this.isOpen?(t.classList.add('active'),document.getElementById('chatInput').focus(),this.unreadMessages=0,this.updateBadge()):t.classList.remove('active')}closeChat(){this.isOpen=!1,document.getElementById('chatWindow').classList.remove('active')}addMessage(t,e){const a=document.getElementById('chatMessages'),l=document.createElement('div');l.className=`message ${e}-message`;const o=new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});l.innerHTML=`<div class="message-content"><p>${t}</p><span class="message-time">${o}</span></div>`,a.appendChild(l),a.scrollTop=a.scrollHeight,this.chatHistory.push({text:t,sender:e,timestamp:(new Date).toISOString()}),this.saveChatHistory()}sendMessage(){const t=document.getElementById('chatInput'),e=t.value.trim();e&&(this.addMessage(e,'user'),t.value='',this.sendToSupport(e))}sendToSupport(t){setTimeout((()=>{const e={beginner:"Our Modern Standard Arabic (MSA) program is perfect for beginners! It starts from absolute basics.",pricing:"We offer flexible packages starting from $15/hour. Family and group discounts available!",trial:"Yes! You can book a FREE 30-minute trial lesson to experience our teaching style.",default:"Thanks for your message! Our team will respond shortly. In the meantime, check our FAQ section for quick answers."};let a=e.default;t.toLowerCase().includes('beginner')?a=e.beginner:t.toLowerCase().includes('cost')||t.toLowerCase().includes('price')?a=e.pricing:(t.toLowerCase().includes('trial')||t.toLowerCase().includes('free'))&&(a=e.trial),this.addMessage(a,'support'),this.isOpen||(this.unreadMessages++,this.updateBadge())}),1e3+1e3*Math.random())}updateBadge(){const t=document.getElementById('chatBadge');t.textContent=this.unreadMessages,t.style.display=this.unreadMessages>0?'block':'none'}saveChatHistory(){localStorage.setItem('ara_chat_history',JSON.stringify(this.chatHistory))}loadChatHistory(){const t=localStorage.getItem('ara_chat_history');if(t){this.chatHistory=JSON.parse(t);const e=this.chatHistory.slice(-10);e.forEach((t=>{document.querySelector(`[data-time="${t.timestamp}"]`)||this.addMessage(t.text,t.sender)}))}}}"undefined"!=typeof window&&(window.LiveChatSystem=LiveChatSystem);