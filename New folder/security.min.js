class FormSecurity{constructor(){this.honeypotFieldName='website_url',this.tokenExpiry=3e5}generateSecurityToken(){const t=Math.random().toString(36).substring(2)+Date.now().toString(36);return sessionStorage.setItem('form_token',t),setTimeout(()=>sessionStorage.removeItem('form_token'),this.tokenExpiry),t}validateToken(t){const e=sessionStorage.getItem('form_token');return e&&e===t}createHoneypot(){return`<div style="position: absolute; left: -9999px;" aria-hidden="true"><label for="${this.honeypotFieldName}">Leave this field blank</label><input type="text" id="${this.honeypotFieldName}" name="${this.honeypotFieldName}" tabindex="-1" autocomplete="off"></div>`}checkHoneypot(t){const e=t.get(this.honeypotFieldName);return!e||""===e}rateLimit(t,e=3,o=9e5){const s=Date.now(),n=JSON.parse(localStorage.getItem(`rate_limit_${t}`)||"[]"),a=n.filter(t=>s-t<o);return!(a.length>=e)&&(a.push(s),localStorage.setItem(`rate_limit_${t}`,JSON.stringify(a)),!0)}cleanupOldAttempts(){const t=Date.now(),e=t-864e5;for(let o=0;o<localStorage.length;o++){const s=localStorage.key(o);if(s&&s.startsWith('rate_limit_')){const n=JSON.parse(localStorage.getItem(s)||"[]"),a=n.filter(t=>t>e);0===a.length?localStorage.removeItem(s):localStorage.setItem(s,JSON.stringify(a))}}}}class SessionSecurity{constructor(){this.sessionTimeout=18e5,this.init()}init(){this.setSessionStart(),this.setupActivityListeners(),this.checkSession(),this.cleanupOldSessions()}setSessionStart(){sessionStorage.getItem('session_start')||(sessionStorage.setItem('session_start',Date.now().toString()),sessionStorage.setItem('last_activity',Date.now().toString()))}setupActivityListeners(){['click','keypress','scroll','mousemove','touchstart'].forEach(t=>{document.addEventListener(t,()=>{sessionStorage.setItem('last_activity',Date.now().toString())},{passive:!0})})}checkSession(){setInterval(()=>{const t=parseInt(sessionStorage.getItem('last_activity')||"0"),e=Date.now();e-t>this.sessionTimeout&&this.handleSessionTimeout()},6e4)}handleSessionTimeout(){const t=window.location.href;sessionStorage.removeItem('session_start'),sessionStorage.removeItem('last_activity'),sessionStorage.removeItem('form_token'),"visible"===document.visibilityState&&(confirm("For your security, the session has expired. Would you like to start a new session?")?(this.setSessionStart(),sessionStorage.setItem('last_activity',Date.now().toString())):window.location.href=t)}cleanupOldSessions(){const t=parseInt(sessionStorage.getItem('session_start')||"0"),e=Date.now();e-t>864e5&&(sessionStorage.clear(),this.setSessionStart())}}class DataProtection{constructor(){this.encryptionKey='Arabfield_Academy_Secure_2025_Protection_Key'}encrypt(t){try{return"string"!=typeof t&&(t=JSON.stringify(t)),btoa(unescape(encodeURIComponent(t+this.encryptionKey)))}catch(e){return console.warn("Encryption failed, returning original data:",e),t}}decrypt(t){try{const e=decodeURIComponent(escape(atob(t)));return e.endsWith(this.encryptionKey)?e.slice(0,-this.encryptionKey.length):e}catch(e){return console.warn("Decryption failed, returning original data:",e),t}}sanitizeInput(t){return null==t?"":"string"!=typeof t&&(t=String(t)),t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#x27;").replace(/"/g,"&quot;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#x60;").trim()}validateEmail(t){if("string"!=typeof t)return!1;const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return e.test(t)&&t.length<=254&&t.length>=5}validatePhone(t){return"string"!=typeof t?!1:/^\+[1-9]\d{1,14}$/.test(t.trim())}validateName(t){if("string"!=typeof t)return!1;const e=this.sanitizeInput(t);return e.length>=2&&e.length<=100&&/^[a-zA-Z\u0600-\u06FF\s\-'.]+$/.test(e)}}class ActivityMonitor{constructor(){this.suspiciousActivities=[],this.maxSuspiciousActivities=10,this.monitoringEnabled=!0}logActivity(t,e={}){if(!this.monitoringEnabled)return;const o={type:t,details:e,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,viewport:`${window.innerWidth}x${window.innerHeight}`};console.log(`ðŸ”’ Security Log [${t}]:`,o),"suspicious"===t&&(this.suspiciousActivities.push(o),this.suspiciousActivities.length>this.maxSuspiciousActivities&&this.suspiciousActivities.shift(),this.checkForSuspiciousPatterns())}detectSuspiciousBehavior(){this.detectRapidClicks(),this.detectRapidFormFilling(),this.detectDevTools()}detectRapidClicks(){let t=0,e=0,o=100,s=8;document.addEventListener('click',s=>{const n=Date.now(),a=n-e;a<o?(t++,t>s&&(this.logActivity('suspicious',{reason:'Excessive rapid clicking detected',clickCount:t,target:s.target.tagName,timeBetweenClicks:a}),t=0)):t=0,e=n},{passive:!0})}detectRapidFormFilling(){document.querySelectorAll('form').forEach(t=>{let e=null,o=0;t.addEventListener('input',s=>{e||(e=Date.now(),o=0,setTimeout(()=>{const s=Date.now()-e;s<2e3&&o>6&&this.logActivity('suspicious',{reason:'Rapid form filling detected',formId:t.id||'unknown',fillDuration:s,fieldsChanged:o}),e=null,o=0},2e3)),o++},{passive:!0})})}detectDevTools(){setInterval(()=>{const t=window.outerWidth-window.innerWidth>160,e=window.outerHeight-window.innerHeight>160;(t||e)&&this.logActivity('info',{reason:'Developer tools detected open'})},1e3)}checkForSuspiciousPatterns(){const t=this.suspiciousActivities.filter(t=>Date.now()-(new Date(t.timestamp)).getTime()<6e4);t.length>=5&&this.handleExcessiveSuspiciousActivity()}handleExcessiveSuspiciousActivity(){this.logActivity('security_alert',{reason:'Excessive suspicious activity detected',activitiesCount:this.suspiciousActivities.length})}}"undefined"!=typeof window&&(window.FormSecurity=FormSecurity,window.SessionSecurity=SessionSecurity,window.DataProtection=DataProtection,window.ActivityMonitor=ActivityMonitor);